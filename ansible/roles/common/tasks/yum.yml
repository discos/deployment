---

- name: Remove yum-cron to avoid yum automatic updates
  yum:
    name: yum-cron
    state: absent


- name: Remove PackageKit* yum packages
  yum:
    name:
      - PackageKit.i686
      - PackageKit.x86_64
      - PackageKit-device-rebind.x86_64
      - PackageKit-glib.x86_64
      - PackageKit-gtk-module.x86_64
      - PackageKit-yum.x86_64
      - PackageKit-yum-plugin.x86_64
      - PackageKit-backend-devel.i686
      - PackageKit-backend-devel.x86_64
      - PackageKit-browser-plugin.x86_64
      - PackageKit-command-not-found.x86_64
      - PackageKit-cron.x86_64
      - PackageKit-debug-install.x86_64
      - PackageKit-docs.noarch
      - PackageKit-glib.i686
      - PackageKit-glib.x86_64
      - PackageKit-glib-devel.i686
      - PackageKit-glib-devel.x86_64
      - PackageKit-gstreamer-plugin.x86_64
      - PackageKit-gtk-module.i686
      - PackageKit-gtk3-module.i686
      - PackageKit-gtk3-module.x86_64
      - PackageKit-qt.i686
      - PackageKit-qt.x86_64
      - PackageKit-qt-devel.i686
      - PackageKit-qt-devel.x86_64
      - PackageKit-Qt.x86_64
      - PackageKit-Qt-devel.x86_64
    state: absent


- name: Install epel-release yum package
  yum:
    name: epel-release
    state: present


- name: Install common required yum packages
  yum:
    name:
      - procmail
      - vim-enhanced
      - subversion
      - unzip
      - openssl
      - screen
      - gnuplot
      - xterm
      - ksh
      - java-1.8.0-openjdk
      - ntp
      - wget
      - perl
      - net-snmp
      - rsync
      - iptables
      - rpcbind
    state: present


- name: Install storage required yum packages
  yum:
    name:
      - sg3_utils
      - lsof
      - attr
      - compat-openmpi16
      - lvm2
      - iptables-services
      - ypserv
    state: present
  when: inventory_hostname in groups['storage']


- name: Install ACS required yum packages
  yum:
    name:
      - gnome-desktop
      - gnome-desktop-devel
      - python-devel
      - gcc-c++
      - gdb
      - cmake
      - expat
      - expat-devel
      - expect
      - gsl
      - gsl-devel
      - boost
      - boost-devel
      - openssl-devel
      - ncurses-devel
      - jpackage-utils
      - ncurses
      - libtool
      - java-1.8.0-openjdk-devel
      - curl-devel
      - perl-devel
      - gettext-devel
      - bzip2-devel
      - ypbind
      - tigervnc-server
      - firefox
      - gedit
      - bluefish
      - dejavu-sans-mono-fonts
    state: present
  when: inventory_hostname in groups['acs']


- block:
    - name: Install the ius_release yum package on console machine
      yum:
        name: "{{ ius_release }}"
        state: present
    - name: Install console required yum packages
      yum:
        name:
          - sshpass
          - python27
          - python27-pip
          - python36u-pip
          - python36u-devel
          - python36u-tkinter
        state: present
  when: inventory_hostname in groups['console']


- name: Install a GUI environment for ACS machines
  yum:
    name:
      - "@X Window System"
      - "@Desktop"
      - "@fonts"
    state: present
  when: inventory_hostname in groups['acs']
