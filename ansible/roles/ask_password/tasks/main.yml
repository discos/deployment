---

- name: Check if user '{{ item.value.name }}' already exists
  command: "getent passwd {{ item.value.uid }}"
  register: user_exists
  failed_when: false


- include_tasks: askpass.yml
  when:
    - user_exists.stdout_lines | length == 0
    - use_default_passwords is not defined
    - use_default_passwords == true
