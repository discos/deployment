---

- name: Install prospector (Python linter)
  command: "{{ item }}"
  with_items:
    - pip install prospector==0.12.11
  become: true
  become_user: "{{ user }}"
  become_flags: "-i"


- name: Install ipython and create default profile
  command: "{{ item[0] }}"
  with_nested:
    - ["pip install ipython", "ipython profile create"]
    - "{{ users }}"
  become: true
  become_user: "{{ item[1].name }}"
  become_flags: "-i"
  no_log: true


- name: Copy the ipython startup files
  template:
    src: ipython_startup_01.py
    dest: "/discos/{{ item.name }}/.ipython/profile_default/startup/01.py"
    owner: "{{ item.name }}"
    group: acs
    mode: 0644
  with_items: "{{ users }}"
  no_log: true
